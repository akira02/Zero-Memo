{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"preact\"","webpack:///../src/index.js","webpack:///./css-util.js","webpack:///./erf.js","webpack:///./shaders.js","webpack:///./render-image.js","webpack:///./components.jsx","webpack:///./image-util.js","webpack:///./index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","currentIndex","currentComponent","prevRaf","currentHook","afterPaintEffects","oldBeforeDiff","options","oldBeforeRender","oldAfterDiff","diffed","oldCommit","oldBeforeUnmount","unmount","getHookState","index","type","hooks","length","push","useState","initialState","reducer","init","hookState","_reducer","invokeOrReturn","nextValue","action","setState","useReducer","useMemo","factory","args","state","argsChanged","flushAfterPaintEffects","forEach","component","invokeCleanup","invokeEffect","e","vnode","requestAnimationFrame","callback","raf","done","clearTimeout","timeout","HAS_RAF","cancelAnimationFrame","setTimeout","commitQueue","some","filter","cb","hook","comp","oldArgs","newArgs","arg","f","prefix","dataView","DataView","ArrayBuffer","erf","x","sign","Math","abs","isNaN","NaN","Infinity","setFloat64","ix","getInt32","z","R","S","setInt32","getFloat64","exp","pixelWeight","stddev","y1","SQRT2","generateShaders","result","offset","weight","radius","ceil","w1","w2","generateSamplePoints","blur","map","toExponential","join","rectangleData","Float32Array","renderImage","image","width","height","canvas","document","createElement","gl","getContext","depth","antialias","pixelStorei","UNPACK_FLIP_Y_WEBGL","rectangleBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","imageTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","fbTexture","fb","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","vsSource","fsSource","vs","createShader","VERTEX_SHADER","shaderSource","compileShader","fs","FRAGMENT_SHADER","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","Error","getProgramInfoLog","useProgram","aPosition","getAttribLocation","uTexture","getUniformLocation","uShape","uBlurDirection","uMixColor","enableVertexAttribArray","vertexAttribPointer","FLOAT","activeTexture","TEXTURE0","uniform1i","uniform2fv","uniform4fv","drawArrays","TRIANGLES","mixColor","Promise","resolve","toBlob","shader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","ImageInput","defaultType","setType","class","onChange","target","required","getImage","formData","OptionsInput","defaultBlur","defaultBrightness","min","max","defaultValue","getOptions","brightness","parseInt","ConfigPanel","onSubmit","preventDefault","FormData","dashboard","plurk","Preview","images","style","timeline","objectURL","Uploader","onDone","isUploading","setIsUploading","canUpload","onClick","err","console","error","alert","urls","all","keys","blob","append","fetch","method","headers","Authorization","body","res","json","success","data","link","disabled","Result","css","textarea","initialValue","current","ref","select","execCommand","generateImages","config","then","fetchResource","sourceBlob","URL","revokeObjectURL","url","createObjectURL","Image","decode","src","reject","onload","onerror","sourceImage","blurScaling","newImages","App","setImages","setCss","oldImages","disposeImages","text","begin","indexOf","end","replacement","generateReplacement","slice","updateCss","href","role"],"mappings":"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","file":"ssr-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"QfWi\");\n","module.exports = require(\"preact\");","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n/**\n * Keep track of the previous component so that we can set\n * `currentComponent` to `null` and throw when a hook is invoked\n * outside of render\n * @type {import('./internal').Component}\n */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\thooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks && c.__hooks._pendingEffects.length) {\n\t\tafterPaint(afterPaintEffects.push(c));\n\t}\n\tcurrentComponent = previousComponent;\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\ttry {\n\t\t\tc.__hooks._list.forEach(invokeCleanup);\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} [initialState]\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = hookState._reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\n/**\n * @param {(error: any) => void} cb\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.forEach(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tif (typeof hook._cleanup == 'function') hook._cleanup();\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","const CSS_URL =\n  \"https://raw.githubusercontent.com/akira02/Zero-Memo/master/plurk.css\";\n\nexport async function fetchCss() {\n  return fetch(CSS_URL).then((res) => res.text());\n}\n\nconst prefix = \"/* ==== BEGIN CONFIGURATION ==== */\";\nconst suffix = \"/* ==== END CONFIGURATION ==== */\";\n\nfunction generateReplacement(urls) {\n  return `\nbody {\n    /* △未模糊背景圖片 */\n    --background-image-timeline: url(${urls.timeline});\n    /* ☆白色模糊背景圖片 */\n    --background-image-plurk: url(${urls.plurk});\n    /* ★黑色模糊背景圖片 */\n    --background-image-dashboard: url(${urls.dashboard});\n}\n`;\n}\n\nexport function updateCss(css, urls) {\n  const begin = css.indexOf(prefix);\n  if (begin == -1) {\n    throw new Error(\"prefix string not found\");\n  }\n  const end = css.indexOf(suffix, begin + prefix.length);\n  if (end == -1) {\n    throw new Error(\"suffix string not found\");\n  }\n  const replacement = generateReplacement(urls);\n  return css.slice(0, begin + prefix.length) + replacement + css.slice(end);\n}\n","/* Ported from fdlibm s_erf.c */\n\n/* @(#)s_erf.c 1.3 95/01/18 */\n/*\n * ====================================================\n * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.\n *\n * Developed at SunSoft, a Sun Microsystems, Inc. business.\n * Permission to use, copy, modify, and distribute this\n * software is freely granted, provided that this notice\n * is preserved.\n * ====================================================\n */\n\nconst tiny = 1e-300,\n  half = 5.0e-1 /* 0x3FE00000, 0x00000000 */,\n  one = 1.0 /* 0x3FF00000, 0x00000000 */,\n  two = 2.0 /* 0x40000000, 0x00000000 */,\n  /* c = (float)0.84506291151 */\n  erx = 8.45062911510467529297e-1 /* 0x3FEB0AC1, 0x60000000 */,\n  /*\n   * Coefficients for approximation to  erf on [0,0.84375]\n   */\n  efx = 1.28379167095512586316e-1 /* 0x3FC06EBA, 0x8214DB69 */,\n  efx8 = 1.02703333676410069053 /* 0x3FF06EBA, 0x8214DB69 */,\n  pp0 = 1.28379167095512558561e-1 /* 0x3FC06EBA, 0x8214DB68 */,\n  pp1 = -3.2504210724700149937e-1 /* 0xBFD4CD7D, 0x691CB913 */,\n  pp2 = -2.84817495755985104766e-2 /* 0xBF9D2A51, 0xDBD7194F */,\n  pp3 = -5.77027029648944159157e-3 /* 0xBF77A291, 0x236668E4 */,\n  pp4 = -2.37630166566501626084e-5 /* 0xBEF8EAD6, 0x120016AC */,\n  qq1 = 3.97917223959155352819e-1 /* 0x3FD97779, 0xCDDADC09 */,\n  qq2 = 6.50222499887672944485e-2 /* 0x3FB0A54C, 0x5536CEBA */,\n  qq3 = 5.08130628187576562776e-3 /* 0x3F74D022, 0xC4D36B0F */,\n  qq4 = 1.32494738004321644526e-4 /* 0x3F215DC9, 0x221C1A10 */,\n  qq5 = -3.9602282787753681232e-6 /* 0xBED09C43, 0x42A26120 */,\n  /*\n   * Coefficients for approximation to  erf  in [0.84375,1.25]\n   */\n  pa0 = -2.36211856075265944077e-3 /* 0xBF6359B8, 0xBEF77538 */,\n  pa1 = 4.14856118683748331666e-1 /* 0x3FDA8D00, 0xAD92B34D */,\n  pa2 = -3.72207876035701323847e-1 /* 0xBFD7D240, 0xFBB8C3F1 */,\n  pa3 = 3.18346619901161753674e-1 /* 0x3FD45FCA, 0x805120E4 */,\n  pa4 = -1.10894694282396677476e-1 /* 0xBFBC6398, 0x3D3E28EC */,\n  pa5 = 3.54783043256182359371e-2 /* 0x3FA22A36, 0x599795EB */,\n  pa6 = -2.166375594868790843e-3 /* 0xBF61BF38, 0x0A96073F */,\n  qa1 = 1.06420880400844228286e-1 /* 0x3FBB3E66, 0x18EEE323 */,\n  qa2 = 5.40397917702171048937e-1 /* 0x3FE14AF0, 0x92EB6F33 */,\n  qa3 = 7.18286544141962662868e-2 /* 0x3FB2635C, 0xD99FE9A7 */,\n  qa4 = 1.26171219808761642112e-1 /* 0x3FC02660, 0xE763351F */,\n  qa5 = 1.36370839120290507362e-2 /* 0x3F8BEDC2, 0x6B51DD1C */,\n  qa6 = 1.1984499846799107417e-2 /* 0x3F888B54, 0x5735151D */,\n  /*\n   * Coefficients for approximation to  erfc in [1.25,1/0.35]\n   */\n  ra0 = -9.86494403484714822705e-3 /* 0xBF843412, 0x600D6435 */,\n  ra1 = -6.93858572707181764372e-1 /* 0xBFE63416, 0xE4BA7360 */,\n  ra2 = -1.05586262253232909814e1 /* 0xC0251E04, 0x41B0E726 */,\n  ra3 = -6.23753324503260060396e1 /* 0xC04F300A, 0xE4CBA38D */,\n  ra4 = -1.62396669462573470355e2 /* 0xC0644CB1, 0x84282266 */,\n  ra5 = -1.84605092906711035994e2 /* 0xC067135C, 0xEBCCABB2 */,\n  ra6 = -8.12874355063065934246e1 /* 0xC0545265, 0x57E4D2F2 */,\n  ra7 = -9.81432934416914548592 /* 0xC023A0EF, 0xC69AC25C */,\n  sa1 = 1.96512716674392571292e1 /* 0x4033A6B9, 0xBD707687 */,\n  sa2 = 1.376577541435190426e2 /* 0x4061350C, 0x526AE721 */,\n  sa3 = 4.34565877475229228821e2 /* 0x407B290D, 0xD58A1A71 */,\n  sa4 = 6.45387271733267880336e2 /* 0x40842B19, 0x21EC2868 */,\n  sa5 = 4.29008140027567833386e2 /* 0x407AD021, 0x57700314 */,\n  sa6 = 1.08635005541779435134e2 /* 0x405B28A3, 0xEE48AE2C */,\n  sa7 = 6.57024977031928170135 /* 0x401A47EF, 0x8E484A93 */,\n  sa8 = -6.04244152148580987438e-2 /* 0xBFAEEFF2, 0xEE749A62 */,\n  /*\n   * Coefficients for approximation to  erfc in [1/.35,28]\n   */\n  rb0 = -9.86494292470009928597e-3 /* 0xBF843412, 0x39E86F4A */,\n  rb1 = -7.99283237680523006574e-1 /* 0xBFE993BA, 0x70C285DE */,\n  rb2 = -1.77579549177547519889e1 /* 0xC031C209, 0x555F995A */,\n  rb3 = -1.60636384855821916062e2 /* 0xC064145D, 0x43C5ED98 */,\n  rb4 = -6.37566443368389627722e2 /* 0xC083EC88, 0x1375F228 */,\n  rb5 = -1.02509513161107724954e3 /* 0xC0900461, 0x6A2E5992 */,\n  rb6 = -4.83519191608651397019e2 /* 0xC07E384E, 0x9BDC383F */,\n  sb1 = 3.03380607434824582924e1 /* 0x403E568B, 0x261D5190 */,\n  sb2 = 3.25792512996573918826e2 /* 0x40745CAE, 0x221B9F0A */,\n  sb3 = 1.53672958608443695994e3 /* 0x409802EB, 0x189D5118 */,\n  sb4 = 3.19985821950859553908e3 /* 0x40A8FFB7, 0x688C246A */,\n  sb5 = 2.55305040643316442583e3 /* 0x40A3F219, 0xCEDF3BE6 */,\n  sb6 = 4.74528541206955367215e2 /* 0x407DA874, 0xE79FE763 */,\n  sb7 = -2.24409524465858183362e1; /* 0xC03670E2, 0x42712D62 */\n\nconst dataView = new DataView(new ArrayBuffer(8));\n\nexport function erf(x) {\n  const sign = x >= 0 ? 1 : -1;\n  x = Math.abs(x);\n\n  if (isNaN(x)) return NaN;\n  if (x === Infinity) return sign * 1;\n\n  dataView.setFloat64(0, x);\n  const ix = dataView.getInt32(0);\n\n  if (ix < 0x3feb0000) {\n    /* |x|<0.84375 */\n    if (ix < 0x3e300000) {\n      /* |x|<2**-28 */\n      if (ix < 0x00800000)\n        return sign * (0.125 * (8.0 * x + efx8 * x)); /*avoid underflow */\n      return sign * (x + efx * x);\n    }\n    const z = x * x;\n    const r = pp0 + z * (pp1 + z * (pp2 + z * (pp3 + z * pp4)));\n    const s = one + z * (qq1 + z * (qq2 + z * (qq3 + z * (qq4 + z * qq5))));\n    const y = r / s;\n    return sign * (x + x * y);\n  }\n  if (ix < 0x3ff40000) {\n    /* 0.84375 <= |x| < 1.25 */\n    const s = x - one;\n    const P =\n      pa0 + s * (pa1 + s * (pa2 + s * (pa3 + s * (pa4 + s * (pa5 + s * pa6)))));\n    const Q =\n      one + s * (qa1 + s * (qa2 + s * (qa3 + s * (qa4 + s * (qa5 + s * qa6)))));\n    return sign * (erx + P / Q);\n  }\n  if (ix >= 0x40180000) {\n    /* inf>|x|>=6 */\n    return sign * (one - tiny);\n  }\n  const s = one / (x * x);\n  let R, S;\n  if (ix < 0x4006db6e) {\n    /* |x| < 1/0.35 */\n    R =\n      ra0 +\n      s *\n        (ra1 +\n          s * (ra2 + s * (ra3 + s * (ra4 + s * (ra5 + s * (ra6 + s * ra7))))));\n    S =\n      one +\n      s *\n        (sa1 +\n          s *\n            (sa2 +\n              s *\n                (sa3 +\n                  s * (sa4 + s * (sa5 + s * (sa6 + s * (sa7 + s * sa8)))))));\n  } else {\n    /* |x| >= 1/0.35 */\n    R =\n      rb0 + s * (rb1 + s * (rb2 + s * (rb3 + s * (rb4 + s * (rb5 + s * rb6)))));\n    S =\n      one +\n      s *\n        (sb1 +\n          s * (sb2 + s * (sb3 + s * (sb4 + s * (sb5 + s * (sb6 + s * sb7))))));\n  }\n  dataView.setInt32(4, 0);\n  const z = dataView.getFloat64(0);\n  const r = Math.exp(-z * z - 0.5625) * Math.exp((z - x) * (z + x) + R / S);\n  return sign * (one - r / x);\n}\n","import { erf } from \"./erf\";\n\nfunction pixelWeight(x, stddev) {\n  const y1 = erf((x - 0.5) / (stddev * Math.SQRT2));\n  const y2 = erf((x + 0.5) / (stddev * Math.SQRT2));\n  return (y2 - y1) / 2;\n}\n\nfunction generateSamplePoints(stddev) {\n  const result = [];\n  result.push({ offset: 0, weight: pixelWeight(0, stddev) });\n\n  const radius = Math.ceil(stddev * 3);\n  for (let i = 1; i <= radius; i += 2) {\n    const w1 = pixelWeight(i, stddev);\n    const w2 = pixelWeight(i + 1, stddev);\n    const offset = (w1 * i + w2 * (i + 1)) / (w1 + w2);\n    const weight = w1 + w2;\n\n    result.push({ offset, weight });\n    result.push({ offset: -offset, weight });\n  }\n  return result;\n}\n\nexport function generateShaders(options) {\n  const samplePoints = generateSamplePoints(options.blur);\n  const vs = `\n    precision highp float;\n    attribute vec2 a_position;\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n    }\n  `;\n  const generateTextureRead = ({ offset, weight }) => {\n    const position = `(gl_FragCoord.xy + u_blurDirection * ${offset.toExponential()}) / u_shape`;\n    return `gl_FragColor += texture2D(u_texture, ${position}) * ${weight.toExponential()};`;\n  };\n  const fs = `\n    precision mediump float;\n    uniform sampler2D u_texture;\n    uniform highp vec2 u_shape;\n    uniform highp vec2 u_blurDirection;\n    uniform vec4 u_mixColor;\n    void main() {\n      gl_FragColor = vec4(0.0);\n      ${samplePoints.map(generateTextureRead).join(\"\\n\")}\n      gl_FragColor = vec4(mix(gl_FragColor.rgb, u_mixColor.rgb, u_mixColor.a), 1.0);\n    }\n  `;\n  return [vs, fs];\n}\n","import { generateShaders } from \"./shaders\";\n\n// prettier-ignore\nconst rectangleData = new Float32Array([\n  -1.0,  1.0,\n  -1.0, -1.0,\n   1.0,  1.0,\n   1.0,  1.0,\n  -1.0, -1.0,\n   1.0, -1.0,\n]);\n\nexport function renderImage(image, options) {\n  const { width, height } = image;\n\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = width;\n  canvas.height = height;\n\n  const gl = canvas.getContext(\"webgl\", { depth: false, antialias: false });\n  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n\n  const rectangleBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, rectangleBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, rectangleData, gl.STATIC_DRAW);\n\n  const imageTexture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, imageTexture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n  const fbTexture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, fbTexture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.RGBA,\n    width,\n    height,\n    0,\n    gl.RGBA,\n    gl.UNSIGNED_BYTE,\n    null\n  );\n\n  const fb = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER,\n    gl.COLOR_ATTACHMENT0,\n    gl.TEXTURE_2D,\n    fbTexture,\n    0\n  );\n\n  const [vsSource, fsSource] = generateShaders(options);\n\n  const vs = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(vs, vsSource);\n  compileShader(gl, vs);\n\n  const fs = gl.createShader(gl.FRAGMENT_SHADER);\n  gl.shaderSource(fs, fsSource);\n  compileShader(gl, fs);\n\n  const program = gl.createProgram();\n  gl.attachShader(program, vs);\n  gl.attachShader(program, fs);\n  linkProgram(gl, program);\n  gl.useProgram(program);\n\n  const aPosition = gl.getAttribLocation(program, \"a_position\");\n  const uTexture = gl.getUniformLocation(program, \"u_texture\");\n  const uShape = gl.getUniformLocation(program, \"u_shape\");\n  const uBlurDirection = gl.getUniformLocation(program, \"u_blurDirection\");\n  const uMixColor = gl.getUniformLocation(program, \"u_mixColor\");\n\n  const blurDirectionX = [1, 0];\n  const blurDirectionY = [0, 1];\n\n  gl.enableVertexAttribArray(aPosition);\n  gl.bindBuffer(gl.ARRAY_BUFFER, rectangleBuffer);\n  gl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, 0, 0);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.uniform1i(uTexture, 0);\n  gl.uniform2fv(uShape, [width, height]);\n\n  // first pass\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n  gl.bindTexture(gl.TEXTURE_2D, imageTexture);\n  gl.uniform2fv(uBlurDirection, blurDirectionX);\n  gl.uniform4fv(uMixColor, [0, 0, 0, 0]);\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n  // second pass\n  gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  gl.bindTexture(gl.TEXTURE_2D, fbTexture);\n  gl.uniform2fv(uBlurDirection, blurDirectionY);\n  gl.uniform4fv(uMixColor, options.mixColor);\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n  return new Promise((resolve) => {\n    canvas.toBlob(resolve, \"image/jpeg\");\n  });\n}\n\nfunction compileShader(gl, shader) {\n  gl.compileShader(shader);\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (!success) {\n    throw new Error(gl.getShaderInfoLog(shader));\n  }\n  return shader;\n}\n\nfunction linkProgram(gl, program) {\n  gl.linkProgram(program);\n  const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (!success) {\n    throw new Error(gl.getProgramInfoLog(program));\n  }\n  return program;\n}\n","import { h, Fragment } from \"preact\";\nimport { useState, useRef } from \"preact/hooks\";\nimport { fetchCss, updateCss } from \"./css-util\";\nimport { decodeImage, uploadImage } from \"./image-util\";\nimport { renderImage } from \"./render-image\";\n\nfunction ImageInput({ defaultType = \"url\", name }) {\n  const [type, setType] = useState(defaultType);\n  return (\n    <div class=\"form-group\">\n      <div class=\"input-group\">\n        <span class=\"input-group-btn\">\n          <select\n            name={name + \"-type\"}\n            class=\"btn\"\n            value={type}\n            onChange={(e) => setType(e.target.value)}\n          >\n            <option value=\"url\">URL</option>\n            <option value=\"file\">檔案/ファイル</option>\n          </select>\n        </span>\n        <input\n          type={type}\n          name={name}\n          class=\"form-control\"\n          required=\"required\"\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction getImage(formData, name) {\n  return {\n    type: formData.get(name + \"-type\"),\n    value: formData.get(name),\n  };\n}\n\nfunction OptionsInput({ name, defaultBlur, defaultBrightness }) {\n  return (\n    <div class=\"form-group\">\n      <label>亮度 明るさを調整</label>\n      <input\n        type=\"range\"\n        name={name + \"-brightness\"}\n        min=\"-100\"\n        max=\"100\"\n        defaultValue={defaultBrightness}\n      />\n\n      <label>模糊 ぼかし</label>\n      <input\n        type=\"range\"\n        name={name + \"-blur\"}\n        min=\"0\"\n        max=\"1000\"\n        defaultValue={defaultBlur}\n      />\n    </div>\n  );\n}\n\nfunction getOptions(formData, name) {\n  const brightness = parseInt(formData.get(name + \"-brightness\")) / 100;\n  const blur = parseInt(formData.get(name + \"-blur\")) / 100;\n  const mixColor =\n    brightness > 0 ? [1, 1, 1, brightness] : [0, 0, 0, -brightness];\n  return { blur, mixColor };\n}\n\nfunction ConfigPanel({ onSubmit }) {\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    const formData = new FormData(e.target);\n\n    onSubmit({\n      image: getImage(formData, \"image-input\"),\n      options: {\n        dashboard: getOptions(formData, \"dashboard\"),\n        plurk: getOptions(formData, \"plurk\"),\n      },\n    });\n  };\n\n  return (\n    <Fragment>\n      <h2>Step.1 設定</h2>\n      <span>先選擇你要的背景圖，設定好你喜歡的明暗透明度、模糊程度並預覽</span>\n      <form onSubmit={handleSubmit}>\n        <h3>背景画像選択</h3>\n        <ImageInput name=\"image-input\" />\n\n        <h3>資訊面板黑背景 深い色の背景</h3>\n        <OptionsInput\n          name=\"dashboard\"\n          defaultBrightness=\"-50\"\n          defaultBlur=\"300\"\n        />\n\n        <h3>噗文白背景 淡い色の背景</h3>\n        <OptionsInput name=\"plurk\" defaultBrightness=\"70\" defaultBlur=\"300\" />\n\n        <button type=\"submit\" class=\"btn btn-primary\">\n          預覽設定プレビュー！\n        </button>\n      </form>\n    </Fragment>\n  );\n}\n\nfunction Preview({ images }) {\n  return (\n    <Fragment>\n      <h2>Step.2 預覽 プレビュー</h2>\n      <div\n        class=\"preview background-timeline\"\n        style={\n          images ? `background-image: url(${images.timeline.objectURL})` : \"\"\n        }\n      >\n        <div\n          class=\"preview-box background-dashboard\"\n          style={\n            images ? `background-image: url(${images.dashboard.objectURL})` : \"\"\n          }\n        >\n          側邊欄\n          <br />\n          <br />\n          統計\n          <br />\n          朋友\n          <br />\n          粉絲\n        </div>\n        <div\n          class=\"preview-box background-plurk\"\n          style={\n            images ? `background-image: url(${images.plurk.objectURL})` : \"\"\n          }\n        >\n          <b>千秋</b>\n          <span class=\"say\">\n            <b>說</b>\n          </span>\n          你好，謝謝你的使用OwO\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nfunction Uploader({ images, onDone }) {\n  const [isUploading, setIsUploading] = useState(false);\n  const canUpload = images != null && !isUploading;\n\n  const handleClick = async () => {\n    if (!canUpload) return;\n\n    setIsUploading(true);\n\n    try {\n      const urls = {};\n\n      await Promise.all(\n        Object.keys(images).map(async (key) => {\n          urls[key] = await uploadImage(images[key].blob);\n        })\n      );\n\n      onDone(urls);\n    } catch (err) {\n      console.error(err);\n      alert(\"上傳失敗\");\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  return (\n    <Fragment>\n      <button\n        type=\"button\"\n        class=\"btn btn-primary\"\n        onClick={handleClick}\n        disabled={!canUpload}\n      >\n        確認產生CSS\n      </button>\n      <span>\n        画像をアップロードする、少々お待ちください((要等蠻久的，好了我會彈個提示\n      </span>\n    </Fragment>\n  );\n}\n\nfunction Result({ css }) {\n  const textarea = useRef(null);\n  const handleClick = () => {\n    textarea.current.select();\n    document.execCommand(\"copy\");\n  };\n  return (\n    <Fragment>\n      <h2>領取CSS</h2>\n      <textarea ref={textarea} class=\"form-control\" style=\"max-height: 500px\">\n        {css}\n      </textarea>\n      <button type=\"button\" class=\"btn btn-default\" onClick={handleClick}>\n        點我複製\n      </button>\n      <span>コピーする！</span>\n    </Fragment>\n  );\n}\n\nasync function fetchResource({ type, value }) {\n  if (type === \"url\") {\n    return fetch(value, { mode: \"cors\" }).then((res) => res.blob());\n  } else if (type === \"file\") {\n    return value;\n  }\n}\n\nasync function generateImages(config) {\n  const sourceBlob = await fetchResource(config.image);\n  const sourceImage = await decodeImage(sourceBlob);\n  const blurScaling = Math.min(sourceImage.width, sourceImage.height) / 200;\n\n  const newImages = {};\n  newImages[\"timeline\"] = {\n    blob: sourceBlob,\n    objectURL: URL.createObjectURL(sourceBlob),\n  };\n  await Promise.all(\n    [\"dashboard\", \"plurk\"].map(async (key) => {\n      const options = config.options[key];\n      const blob = await renderImage(sourceImage, {\n        ...options,\n        blur: options.blur * blurScaling,\n      });\n      newImages[key] = { blob, objectURL: URL.createObjectURL(blob) };\n    })\n  );\n  return newImages;\n}\n\nfunction disposeImages(oldImages) {\n  if (oldImages == null) return;\n  for (const key in oldImages) {\n    URL.revokeObjectURL(oldImages[key].objectURL);\n  }\n}\n\nexport function App() {\n  const [images, setImages] = useState(null);\n  const [css, setCss] = useState(\"\");\n\n  const handleNewConfig = async (config) => {\n    try {\n      setCss(\"\");\n      const newImages = await generateImages(config);\n      setImages((oldImages) => {\n        disposeImages(oldImages);\n        return newImages;\n      });\n      alert(\"好惹\");\n    } catch (err) {\n      console.error(err);\n      alert(\"☆生☆成☆大☆失☆敗☆\");\n    }\n  };\n\n  const handleUploadDone = async (urls) => {\n    const css = await fetchCss();\n    setCss(updateCss(css, urls));\n  };\n\n  return (\n    <div class=\"container\">\n      <h1>\n        Zero-Memo模糊背景產生器·改<small>beta</small>\n      </h1>\n\n      <hr />\n\n      <div class=\"row\">\n        <div class=\"col-md-6\">\n          <ConfigPanel onSubmit={handleNewConfig} />\n        </div>\n        <div class=\"col-md-6\">\n          <Preview images={images} />\n          <Uploader images={images} onDone={handleUploadDone} />\n          <Result css={css} />\n\n          <a\n            href=\"https://www.plurk.com/akira02/invite/4\"\n            class=\"btn btn-outline-danger\"\n            role=\"button\"\n          >\n            喜歡請追蹤千秋的噗浪&lt;3\n            <br />\n            フォローしてください\n          </a>\n        </div>\n      </div>\n    </div>\n  );\n}\n","export async function decodeImage(blob) {\n  const url = URL.createObjectURL(blob);\n  try {\n    const image = new Image();\n    if (image.decode) {\n      image.src = url;\n      await image.decode();\n    } else {\n      await new Promise((resolve, reject) => {\n        image.onload = resolve;\n        image.onerror = reject;\n        image.src = url;\n      });\n    }\n    return image;\n  } finally {\n    URL.revokeObjectURL(url);\n  }\n}\n\nexport async function uploadImage(blob) {\n  const formData = new FormData();\n  formData.append(\"image\", blob);\n\n  const res = await fetch(\"https://api.imgur.com/3/image.json\", {\n    method: \"POST\",\n    headers: {\n      Authorization: \"Client-ID f28cb80465f9e25\",\n    },\n    body: formData,\n  });\n\n  const json = await res.json();\n\n  if (json.success) {\n    return json.data.link;\n  } else {\n    throw new Error(json.data.error);\n  }\n}\n","import { App } from \"./components\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"./style.css\";\n\nexport default App;\n"],"sourceRoot":""}